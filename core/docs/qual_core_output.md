<!-- Generated by QualTableYaml.generateMarkdown(). DO NOT EDIT! -->

# Qualification core output format

This document contains the definitions of the tables generated by the core
Qualification tool.

The qualification tool will create a directory `qual_core_output` in the output directory.
The summary report goes to subfolder `qual_core_output`

## Directory structure

The tool generates summary reports located directly under `qual_core_output` directory
along with detailed per-app reports located under `qual_core_output/*` sub-directory
depending on the type of the report type.

The tree structure of the output directory is as follows:

```
qual_core_output
├── apps_summary.csv
├── status.csv
├── runtime.properties
├── tuning
├── raw_metrics
└── qual_metrics
      ├── app-001-0001
      |   ├── cluster_information.json
      |   ├── execs.csv
      |   ├── operators_stats.csv
      |   ├── persql.csv
      |   ├── stages.csv
      |   ├── unsupported_operators.csv
```
- **raw_metrics**: contains the raw Spark metrics report in CSV formats
- **qual_metrics**: contains the qualification metrics report in CSV formats
- **tuning**: contains per-app AutoTuner recommendations.

## Backward compatibility note (prior to 25.06 release)

With 25.06 release, the output structure of the qual core has changed:

| Element | Legacy | 25.06+ |
| --- | --- | --- |
| root dir | `rapids_4_spark_qualification_output` | `qual_core_output` |
| apps summary | `rapids_4_spark_qualification_output.csv` | `apps_summary.csv` |
| status | `rapids_4_spark_qualification_status.csv` | `status.csv` |
| per-sql report | `rapids_4_spark_qualification_output_persql.csv` | per-app qual_metrics `persql.csv` |
| execs report | `rapids_4_spark_qualification_output_execs.csv` | per-app qual_metrics `execs.csv` |
| unsupported ops | `rapids_4_spark_qualification_output_unsupportedOperators.csv` | per-app qual_metrics `unsupported_operators.csv` |
| stages report | `rapids_4_spark_qualification_output_stages.csv` | per-app qual_metrics `stages.csv` |
| cluster CSV report | `rapids_4_spark_qualification_output_cluster_information.csv` | Removed |
| cluster Json report | `rapids_4_spark_qualification_output_cluster_information.json` | per-app qual_metrics `cluster_information.json` |

**Note**: In addition to the above changes in file names, the column 'App ID' has been removed from the per-app CSV reports.

## Qualification Table definitions

This document contains the definitions of the tables generated by the core
Qualification tool.

The output files are defined in the following format:
* label: The label of the table.
* scope: The scope of the table. This can be either "global" or "per-app".
* description: The description of the table.
* fileFormat: the type of the generated file. By default, it is CSV file unless specified.
* fileName: The name of the file where the table should be written.
* columns: The columns of the table.
  * name: column name.
  * dataType: column data type.
  * description: column description.


### coreCSVStatus

* _Scope_: global
* _File name_: status.csv
* _Format_: CSV
* _Description_: Status of each eventlog passed to the qualification tool. The status is either success, failure, skipped, or unknown (failure). Some rows in that file might not contain App ID depending on the status of the parser.

| Column Name | Description |
| --- | --- |
| Event Log | Path to the eventlog file |
| Status | Results of the processing of the eventlog. It can be: success the tool successfully processed the entire events failure an exception was thrown by the tool skipped the eventlog is not supported by the tool (i.e., streaming and GPU eventlogs) unknown an unexpected kind of failure happened |
| App ID | ID of the app associated with the eventlog. If the eventlog failed to be processed, this value is empty. |
| Attempt ID | Attempt ID of the app associated with the eventlog. For Yarn, the Unique ID of the app is the concatenation of the application ID and the attempt ID. |
| App Name | Name of application associated with the eventlog. |
| Description | Contains the details of the failure reason for a given eventlog. If the eventlog succeeded, this value contains the total processing time of that file. |

### qualCoreCSVSummary

* _Scope_: global
* _File name_: apps_summary.csv
* _Format_: CSV
* _Description_: Summary of each eventlog successfully processed by the tool.

| Column Name | Description |
| --- | --- |
| App Name | Name of application associated with the eventlog. |
| App ID | ID of the app associated with the eventlog |
| Attempt ID | Attempt ID of the app associated with the eventlog. For Yarn, the Unique ID of the app is the concatenation of the application ID and the attempt ID. |
| App Duration | Wall-Clock time in milliseconds measured since the application starts until it's completed. If an app isn't completed an estimated completion time would be computed. The estimated completion is based on the last event being processed by the tool. |
| Executor CPU Time Percent | This is an estimate at how much time the tasks spent doing processing on the CPU versus waiting on IO. This isn’t always a good indicator because sometimes the IO that’s encrypted and the CPU has to do work to decrypt it, so the environment you are running on needs to be taken into account. |
| SQL Ids with Failures | A list SQL Ids of comma separated query Ids with failed jobs. |
| Unsupported Read File Formats and Types | A list of semi-colon separated file formats and types. Each item reports the file formats along with types that may not be fully supported. |
| Unsupported Write Data Format | A list of semi-colon separated strings. Format of the data that is not supported for writing. |
| Complex Types | A list of semi-colon separated strings. It reports the types of data complex types that are not supported for reading (array, struct, or maps). |
| Nested Complex Types | A list of semi-colon separated strings. Nested complex types are complex types that contain other complex types (i.e, array<struct<string,string>>). It can read all the schemas for DataSource V1. The Data Source V2 truncates the schema, so if you see “...”, then the full schema isn’t available. For such schemas we read until '...' and report if there are any complex types and nested complex types in that. |
| Potential Problems | A list of semi-colon separated strings. Some UDFs and nested complex types. Keep in mind that the tool is only able to detect certain issues. |
| Longest SQL Duration | The maximum amount of time spent in a single task of SQL Dataframe operations. |
| SQL Stage Durations Sum | The total wallClockDuration of all the stages in the app. The wallClockDuration is calculated as (submissionTime - completionTime) of the given stage |
| App Duration Estimated | Whether the app duration is estimated or not(true/false). If we had to estimate it, the value will be 'True' and it means the eventlog was missing the application finished event, so we will use the last job or sql execution time we find as the end time used to calculate the duration. |
| Total Core Seconds | Sums the execution time for all executors multiplied by the number of cores in each executor to get total core seconds for the application. |

### perSqlCSVReport

* _Scope_: per-app
* _File name_: persql.csv
* _Format_: CSV
* _Description_: Report containing the details of each SQL in the app

| Column Name | Description |
| --- | --- |
| Root SQL ID | The root SQL ID for each triggered SQL |
| SQL ID | The SQL ID for each triggered SQL(root SQL ID is the parent SQL ID) |
| SQL Description | The description of the SQL |
| SQL DF Duration | The duration of the SQL |
| GPU Opportunity | The expected duration of the SQL on GPU |

### execCSVReport

* _Scope_: per-app
* _File name_: execs.csv
* _Format_: CSV
* _Description_: Report containing the details of each executor in the SQL

| Column Name | Description |
| --- | --- |
| SQL ID | The associated SQL ID for the executor |
| Exec Name | The name of the executor |
| Expression Name | The name of the expression in the executor |
| Exec Duration | The duration of the executor |
| SQL Node Id | The Node ID of the associated SQL with the exec |
| Exec Is Supported | Whether the executor is supported or not(true/false) |
| Exec Stages | The stages of the executor |
| Exec Children | The children of the executor |
| Exec Children Node Ids | The Node IDs of the children of the executor |
| Exec Should Remove | Whether the executor should be removed or not(true/false). The value is 'True' when the Exec is removed from the GPU migrated plan. |
| Exec Should Ignore | Whether the executor should be ignored or not(true/false) |
| Action | The action to be taken for Exec. It can be one of the following: NONE if the Exec is supported, IgnoreNoPerf if the Exec is removed from the migrated plan, IgnorePerf if the Exec has an impact on performance but it is not likely to be handled by the RAPIDS plugin, or Triage if the Exec has an impact on performance and it is likely to be handled by the RAPIDS plugin. |

### unsupportedOpsCSVReport

* _Scope_: per-app
* _File name_: unsupported_operators.csv
* _Format_: CSV
* _Description_: Report containing the details of each unsupported operator in the SQL

| Column Name | Description |
| --- | --- |
| SQL ID | The associated SQL ID for the unsupported operator |
| Stage ID | The associated stage ID for the unsupported operator |
| ExecId | The associated executor ID for the unsupported operator |
| Unsupported Type | The type of the unsupported operator (i.e., Exec or Expression) |
| Unsupported Operator | The details of the unsupported operator |
| Details | The details of the unsupported operator |
| Stage Duration | The duration of the stage in milliseconds. It is calculated as the difference between submission and completion times |
| App Duration | The duration of the app |
| Action | The action to be taken for the unsupported operator. It can be one of the following: IgnoreNoPerf if the Exec is removed from the migrated plan, IgnorePerf if the Exec has an impact on performance but it is not likely to be handled by the RAPIDS plugin, or Triage if the Exec has an impact on performance and it is likely to be handled by the RAPIDS plugin. |

### operatorsStatsCSVReport

* _Scope_: per-app
* _File name_: operators_stats.csv
* _Format_: CSV
* _Description_: Report containing the details of each operator in the SQL

| Column Name | Description |
| --- | --- |
| SQL ID | The associated SQL ID for the operator |
| Operator Type | The type of the operator (expression or exec) |
| Operator Name | The name of the operator |
| Count | The total count of the operator in the given SQL ID. Note that this count is scoped by (un/-supported) flag. |
| Supported | Whether the operator is supported or not(true/false) |
| Stages | Colon separated list of the stages of the operator |

### stagesCSVReport

* _Scope_: per-app
* _File name_: stages.csv
* _Format_: CSV
* _Description_: Report containing the details of each stage in the SQL

| Column Name | Description |
| --- | --- |
| Stage ID | The associated stage ID for the stage |
| Stage Task Duration | Calculated as the total of all the task durations for that stage |
| Unsupported Task Duration | Part of the stage task duration that is not supported |
| Stage Estimated | Whether the stage runtime is estimated or not(true/false) |

### clusterInfoJSONReport

* _Scope_: per-app
* _File name_: cluster_information.json
* _Format_: JSON
* _Description_: Report containing the details of the cluster

| Column Name | Description |
| --- | --- |
| appName | The name of the app for the associated eventlog |
| appId | The ID of the app for the associated eventlog |
| eventLogPath | The path of the eventlog for the associated app |
| sourceClusterInfo | The source cluster information for the associated app (dictionary containing the cluster information) |
| recommendedClusterInfo | The recommended cluster information for the associated app (dictionary containing the cluster information). This field is only enabled when the AutoTuner argument is added to the tool's argument |

### clusterTagsCSVReport

* _Scope_: per-app
* _File name_: clusters_tags.csv
* _Format_: CSV
* _Description_: Report containing the details of the cluster tags

| Column Name | Description |
| --- | --- |
| Property Name | The name of the property |
| Property Value | The value of the property |

### mlFunctionsCSVReport

* _Scope_: per-app
* _File name_: ml_functions.csv
* _Format_: CSV
* _Description_: Report containing the details of the ML functions

| Column Name | Description |
| --- | --- |
| Stage ID | The stage IDs of the ML functions |
| ML Functions | The ML functions in the stage |
| Stage WallClock Duration (ms) | Calculated as (submissionTime - completionTime) of the given stage |

### mlFunctionsDurationsCSVReport

* _Scope_: per-app
* _File name_: ml_functions_durations.csv
* _Format_: CSV
* _Description_: Report containing the details of the ML functions durations

| Column Name | Description |
| --- | --- |
| Stage Ids | The stage IDs of the ML functions |
| ML Function Name | The ML functions name in the stage |
| Total Duration | The total duration of the ML functions |
